<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VPN ‡πÄ‡∏ä‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body { font-family: sans-serif; margin: 20px; background: #f4f4f4; }
    .download-btn { padding: 10px 20px; background: #ff6600; color: white; border: none; border-radius: 10px; cursor: pointer; }
    #qrBox { margin-top: 10px; }
    #receipt-confirmation { margin-top: 20px; background: #d7ffd9; padding: 10px; border-radius: 10px; display: none; }
    input, select, button { padding: 8px; margin: 5px 0; border-radius: 8px; border: 1px solid #ccc; }
  </style>
</head>
<body>

<h2>üì¶ ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ VPN</h2>

<label>‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</label>
<select id="channel">
  <option value="promptpay">PromptPay</option>
  <option value="truemoney">TrueMoney</option>
</select><br>

<label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à:</label>
<select id="category">
  <option value="‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô">‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</option>
  <option value="‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå">‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</option>
  <option value="‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô">‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
</select><br>

<label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó):</label>
<input type="number" id="customAmount" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" style="width: 100px;"><br>

<label>‡πÉ‡∏™‡πà‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):</label>
<input type="text" id="discountCode" placeholder="‡πÄ‡∏ä‡πà‡∏ô VIP10">
<div id="discountResult"></div><br>

<button onclick="generateQR()">‡∏™‡∏£‡πâ‡∏≤‡∏á QR / ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
<div id="qrBox"></div>
<a id="downloadLink" style="display:none;" target="_blank">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î QR</a>
<br>

<label id="slipLabel" style="display:none;">‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ:</label><br>
<input type="file" id="slipInput" style="display:none;"><br>
<small id="slipNote" style="display:none;">* ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏û .jpg .png</small><br>

<button id="notifyBtn" onclick="notifyTelegram()" style="display:none;">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>

<div id="receipt-confirmation">
  ‚úÖ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì! ‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠: 
  <strong id="receipt-code-display" style="color:green;"></strong>
</div>

<script>
  const promptpay = "0620167462";
  const walletUrl = "https://tmn.app.link/LqKi0gjq1Tb";
  const botToken = "‡πÉ‡∏™‡πà‡πÇ‡∏ó‡πÄ‡∏Ñ‡∏ô‡∏ö‡∏≠‡∏ó‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì";
  const chatId = "‡πÉ‡∏™‡πà‡πÅ‡∏ä‡∏ó‡πÑ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì";
  let amount = 0;
  let finalAmount = 0;

  const discountCodes = {
    "VIP10": { discount: 10, expires: "2025-12-31" },
    "GAME20": { discount: 20, expires: "2025-12-31" },
    "PRO50": { discount: 50, expires: "2025-12-31" }
  };

  document.getElementById('slipInput').addEventListener('change', function () {
    document.getElementById('slipLabel').style.display = this.files.length > 0 ? 'block' : 'none';
  });

  function generateReceiptCode() {
    const now = new Date();
    const mm = String(now.getMonth() + 1).padStart(2, '0');
    const dd = String(now.getDate()).padStart(2, '0');
    const randomNum = Math.floor(1000 + Math.random() * 9000);
    return `VPN${mm}${dd}-${randomNum}`;
  }

  async function generateQR() {
    const channel = document.getElementById('channel').value;
    const category = document.getElementById('category').value;
    const qrBox = document.getElementById('qrBox');
    const downloadLink = document.getElementById('downloadLink');
    const notifyBtn = document.getElementById('notifyBtn');
    const slipLabel = document.getElementById('slipLabel');
    const slipNote = document.getElementById('slipNote');
    const customAmount = document.getElementById('customAmount');
    const discountInput = document.getElementById('discountCode').value.trim().toUpperCase();
    const discountResult = document.getElementById('discountResult');

    qrBox.innerHTML = "";
    downloadLink.style.display = "none";
    notifyBtn.style.display = "none";
    slipLabel.style.display = "none";
    slipNote.style.display = "none";

    const inputAmount = parseFloat(customAmount.value);
    if (!isNaN(inputAmount)) amount = inputAmount;

    if (amount <= 0 || isNaN(amount)) {
      alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
      return;
    }

    finalAmount = amount;
    if (discountCodes[discountInput]) {
      const { discount, expires } = discountCodes[discountInput];
      const today = new Date().toISOString().split("T")[0];
      if (today <= expires) {
        finalAmount = Math.ceil(amount - (amount * discount / 100));
        discountResult.innerText = `‚úÖ ‡πÇ‡∏Ñ‡πâ‡∏î "${discountInput}" ‡∏•‡∏î ${discount}% ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ${finalAmount} ‡∏ö‡∏≤‡∏ó`;
        discountResult.style.color = "#00e676";
      } else {
        discountResult.innerText = `‚ö†Ô∏è ‡πÇ‡∏Ñ‡πâ‡∏î "${discountInput}" ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß`;
        discountResult.style.color = "#ffcc00";
      }
    } else if (discountInput !== "") {
      discountResult.innerText = `‚ùå ‡πÇ‡∏Ñ‡πâ‡∏î "${discountInput}" ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á`;
      discountResult.style.color = "#ff5252";
    } else {
      discountResult.innerText = "";
    }

    if (channel === 'truemoney') {
      const walletButton = document.createElement('a');
      walletButton.href = walletUrl;
      walletButton.target = "_blank";
      walletButton.innerHTML = `<button class='download-btn'><i class='fas fa-wallet'></i> ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ TrueMoney Wallet</button>`;
      qrBox.appendChild(walletButton);

      notifyBtn.style.display = "inline-block";
      slipLabel.style.display = "inline-block";
      slipNote.style.display = "block";
      return;
    }

    try {
      const response = await fetch(`https://www.pp-qr.com/api/${promptpay}/${finalAmount}`);
      const data = await response.json();
      if (response.ok) {
        const qrImage = document.createElement('img');
        qrImage.src = data.qrImage;
        qrImage.alt = "QR Code";
        qrImage.style.cssText = "max-width: 100%; margin-top: 10px; border-radius: 10px;";
        qrBox.appendChild(qrImage);

        downloadLink.href = data.qrImage;
        downloadLink.download = `qr_${channel}_${category}.png`;
        downloadLink.style.display = "inline-block";

        notifyBtn.style.display = "inline-block";
        slipLabel.style.display = "inline-block";
        slipNote.style.display = "block";

        const receiptCode = generateReceiptCode();
        document.getElementById("receipt-confirmation").style.display = "block";
        document.getElementById("receipt-code-display").innerText = receiptCode;
      } else {
        alert(data.error || "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡πÑ‡∏î‡πâ");
      }
    } catch (err) {
      alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API");
      console.error(err);
    }
  }

  async function notifyTelegram() {
    const channel = document.getElementById('channel').value;
    const category = document.getElementById('category').value;
    const slipInput = document.getElementById('slipInput');
    const file = slipInput.files[0];

    if (!file) {
      alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô");
      return;
    }

    const formData = new FormData();
    formData.append("chat_id", chatId);
    formData.append("caption", `üì¢ ‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏≠‡∏ô\nüí∏ ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á: ${channel}\nüìÅ ‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à: ${category}\nüí∞ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${finalAmount} ‡∏ö‡∏≤‡∏ó`);
    formData.append("photo", file);

    try {
      const res = await fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
        method: "POST",
        body: formData
      });
      const data = await res.json();
      if (data.ok) {
        alert("‚úÖ ‡∏™‡πà‡∏á‡∏™‡∏•‡∏¥‡∏õ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!");
      } else {
        alert("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏™‡∏•‡∏¥‡∏õ‡πÑ‡∏î‡πâ");
        console.log(data);
      }
    } catch (err) {
      console.error(err);
      alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Ç‡∏ì‡∏∞‡∏™‡πà‡∏á‡∏™‡∏•‡∏¥‡∏õ");
    }
  }
</script>

</boawait/html>

